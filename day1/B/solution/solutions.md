#### strlist

先不管左右中括号。$s^i$ 的第 $j$ 个字符在 $s^{i+1}$，会在 $5j+2$ 上复制一个自己，$5j+1$ 和 $5j+3$ 上根据自己是否是单引号放上单引号或双引号，会在 $5j$ 上放一个空格，$5j+4$ 上放一个逗号。当 $j \bmod p$ 确定的时候，这五个位置 $\bmod\ p$ 也是确定的，这引导我们直接把所有 $\bmod p$ 相等的位置的信息记录下来。

设计以下递推信息：首先肯定要有所求的答案，即 $f_{i,j}$ 表示 $s^i$ 里下标 $\bmod p=j$ 的位置的 ASCII 码和。由于单引号转移与其他字符不同，因此还需要记录 $g_{i,j}$ 表示 $s^i$ 里下标 $\bmod p=j$ 的位置中有多少个单引号，以及 $h_{i,j}$ 表示 $s^i$ 里有多少个下标 $\bmod p=j$ 的位置。

$h$ 的转移是容易的。对于 $f$，我们直接按照题面描述进行转移，以下所有下标都在 $\bmod p$ 意义下：

- $f_{i+1,5j+2} \leftarrow f_{i+1,5j+2}+f_{i,j}$，即复制自己；
- $f_{i+1,5j+3} \leftarrow f_{i+1,5j+3}+g_{i,j} \times 34 + (h_{i,j}-g_{i,j}) \times 39$，即单引号的位置加入双引号（ASCII 34），其他位置加入单引号（ASCII 39）。$f_{i+1,5j+1}$ 类似。
- $f_{i+1,5j} \leftarrow f_{i+1,5j} + h_{i,j} \times 32$，即所有位置都加入一个空格。$f_{i+1,5j+4}$ 类似。

对于左中括号，只需要在 $f_{i+1,0}$ 的位置减掉一个空格再加上一个左括号即可。右中括号同理，需要维护一下字符串长度 $\bmod p$。

$g$ 的转移也是类似的：

- $g_{i+1,5j+2} \leftarrow g_{i+1,5j+2} + g_{i,j}$，即复制自己（~~Fun Fact: 我和验题人小 E 最开始都漏掉了这个，是被 vp 大哥们发现的~~）
- $g_{i+1,5j+3} \leftarrow g_{i+1,5j+3} + (h_{i,j}-g_{i,j})$，即当自己不是单引号的时候 $5j+3$ 位置就会有一个单引号。$g_{i+1,5j+1}$ 同理。

注意初始化的时候不要漏掉单引号对 $g$ 的贡献。复杂度 $\Theta(|s| + kp)$，可以通过。