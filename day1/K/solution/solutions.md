#### K

首先先分析最终未被击倒的员工的形式。可以发现，要么只剩左边界的 $\texttt{R}$，要么剩右边界的 $\texttt{L}$，要么剩中间的一对 $\texttt{LR}$。（如果剩的更多，那么其中间的人发射的子弹一定会击中某一目标，因此至多剩两个不相对的）。

之后可以发现，两人未被击倒的概率等于 $i$ 没有被 $1\sim i-1$ 击倒的概率乘上 $i+1$ 没有被 $[i+2,n]$ 击倒的概率，两部分是独立的，可以分别计算。下面以 $i$ 没有被 $1\sim i-1$ 击倒的概率为例。

从 $i$ 到 $1$ 依次考虑每个 $j$ 在 $[j,i]$ 中的相对顺序，如果 $s_j$ 是 $\texttt{L}$ 那么没有任何限制，如果 $s_j$ 是 $\texttt{R}$ 那么 $j$ 一定不能是 $[j,i]$ 中相对顺序的第一个（如果不是第一个，那么第一个一定是一个 $\texttt{L}$，$j$ 会直接被这个 $\texttt{L}$ 击倒，不受影响）。所以这里的概率是 $\frac{j-i}{j-i+1}$。

所以最终要求的形式大致是 $\prod\limits_{j=1}^i ( \dfrac{j-i}{j-i+1})^{[s_j==\texttt{R}]}$ 的形式。

一种方式是直接取对数，可以发现变成了卷积的形式，可以 NTT 优化（注意取对数之后卷积的模数应该是 $mod-1$，不能直接 NTT，但由于本题卷积的一个多项式是 $01$ 多项式，值域所以最终值域不超过 $n\times mod$，可以用双模 NTT），如果直接使用 BSGS + 线性筛 预处理 $1\sim n$ 的离散对数复杂度是 $O(\sqrt{\dfrac{n}{\ln n}mod}+n\log n)$ 的。可以用一些其他方法做到更快。

也可以直接看成一个类似于多项式多点求值的问题，看成若干个前缀 $(x-i)$ 相乘，可以做到 $O(n\log^2 n)$。