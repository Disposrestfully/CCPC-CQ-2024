题意简述：一个序列，遇到 0 就买入，遇到 1 就卖出，如果有余量就能卖，多次区间询问有多少次成功交易。

尝试进行扫描线处理这个问题，整体考虑答案是麻烦的，每个颜色是独立的。所以我们尝试对于单个颜色考虑贡献。

注意到，对于当前一个靠右的卖出，我们一定尝试对应一个最靠右的买入，此时按照 r 进行扫描线，当遇到一个卖出则在对应可加入的买入位置加上 1 的权值，区间询问即可，总复杂度 $O(n\log n)$。

